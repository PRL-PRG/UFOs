context("UFO vector subsetting")

test_ufo_subset <- function (data, subscript, ufo_constructor) {
  ufo <- ufo_constructor(length(data))
  ufo[seq_len(length(data))] <- data
  result <- ufovectors::ufo_subset(ufo, subscript)
  expect_equal(result, data[subscript])
}

test_that("ufo integer subset: NULL",       {test_ufo_subset(data=as.integer(1:100000), subscript=NULL,             ufo_integer)})
test_that("ufo integer subset: 0",          {test_ufo_subset(data=as.integer(1:100000), subscript=0,                ufo_integer)})
test_that("ufo integer subset: 1",          {test_ufo_subset(data=as.integer(1:100000), subscript=1,                ufo_integer)})
test_that("ufo integer subset: N/2",        {test_ufo_subset(data=as.integer(1:100000), subscript=50000,            ufo_integer)})
test_that("ufo integer subset: N",          {test_ufo_subset(data=as.integer(1:100000), subscript=100000,           ufo_integer)})
test_that("ufo integer subset: 1:10",       {test_ufo_subset(data=as.integer(1:100000), subscript=1:10,             ufo_integer)})
test_that("ufo integer subset: 1:1000",     {test_ufo_subset(data=as.integer(1:100000), subscript=1:1000,           ufo_integer)})
test_that("ufo integer subset: 1:N",        {test_ufo_subset(data=as.integer(1:100000), subscript=1:100000,         ufo_integer)})
test_that("ufo integer subset: N/2:N",      {test_ufo_subset(data=as.integer(1:100000), subscript=50000:100000,     ufo_integer)})
test_that("ufo integer subset: 2*(2:N/2)",  {test_ufo_subset(data=as.integer(1:100000), subscript=2*(1:50000),      ufo_integer)})
test_that("ufo integer subset: -1",         {test_ufo_subset(data=as.integer(1:100000), subscript=-1,               ufo_integer)})
test_that("ufo integer subset: -(N/2)",     {test_ufo_subset(data=as.integer(1:100000), subscript=-50000,           ufo_integer)})
test_that("ufo integer subset: -N",         {test_ufo_subset(data=as.integer(1:100000), subscript=-100000,          ufo_integer)})
test_that("ufo integer subset: -(1:10)",    {test_ufo_subset(data=as.integer(1:100000), subscript=-(1:10),          ufo_integer)})
test_that("ufo integer subset: -(1:1000)",  {test_ufo_subset(data=as.integer(1:100000), subscript=-(1:1000),        ufo_integer)})
test_that("ufo integer subset: -(1:N)",     {test_ufo_subset(data=as.integer(1:100000), subscript=-(1:100000),      ufo_integer)})
test_that("ufo integer subset: -(N/2:N)",   {test_ufo_subset(data=as.integer(1:100000), subscript=-(50000:100000),  ufo_integer)})
test_that("ufo integer subset: -2*(2:N/2)", {test_ufo_subset(data=as.integer(1:100000), subscript=-2*(1:50000),     ufo_integer)})

test_that("ufo numeric subset: NULL",       {test_ufo_subset(data=as.numeric(1:100000), subscript=NULL,             ufo_numeric)})
test_that("ufo numeric subset: 0",          {test_ufo_subset(data=as.numeric(1:100000), subscript=0,                ufo_numeric)})
test_that("ufo numeric subset: 1",          {test_ufo_subset(data=as.numeric(1:100000), subscript=1,                ufo_numeric)})
test_that("ufo numeric subset: N/2",        {test_ufo_subset(data=as.numeric(1:100000), subscript=50000,            ufo_numeric)})
test_that("ufo numeric subset: N",          {test_ufo_subset(data=as.numeric(1:100000), subscript=100000,           ufo_numeric)})
test_that("ufo numeric subset: 1:10",       {test_ufo_subset(data=as.numeric(1:100000), subscript=1:10,             ufo_numeric)})
test_that("ufo numeric subset: 1:1000",     {test_ufo_subset(data=as.numeric(1:100000), subscript=1:1000,           ufo_numeric)})
test_that("ufo numeric subset: 1:N",        {test_ufo_subset(data=as.numeric(1:100000), subscript=1:100000,         ufo_numeric)})
test_that("ufo numeric subset: N/2:N",      {test_ufo_subset(data=as.numeric(1:100000), subscript=50000:100000,     ufo_numeric)})
test_that("ufo numeric subset: 2*(2:N/2)",  {test_ufo_subset(data=as.numeric(1:100000), subscript=2*(1:50000),      ufo_numeric)})
test_that("ufo numeric subset: -1",         {test_ufo_subset(data=as.numeric(1:100000), subscript=-1,               ufo_numeric)})
test_that("ufo numeric subset: -(N/2)",     {test_ufo_subset(data=as.numeric(1:100000), subscript=-50000,           ufo_numeric)})
test_that("ufo numeric subset: -N",         {test_ufo_subset(data=as.numeric(1:100000), subscript=-100000,          ufo_numeric)})
test_that("ufo numeric subset: -(1:10)",    {test_ufo_subset(data=as.numeric(1:100000), subscript=-(1:10),          ufo_numeric)})
test_that("ufo numeric subset: -(1:1000)",  {test_ufo_subset(data=as.numeric(1:100000), subscript=-(1:1000),        ufo_numeric)})
test_that("ufo numeric subset: -(1:N)",     {test_ufo_subset(data=as.numeric(1:100000), subscript=-(1:100000),      ufo_numeric)})
test_that("ufo numeric subset: -(N/2:N)",   {test_ufo_subset(data=as.numeric(1:100000), subscript=-(50000:100000),  ufo_numeric)})
test_that("ufo numeric subset: -2*(2:N/2)", {test_ufo_subset(data=as.numeric(1:100000), subscript=-2*(1:50000),     ufo_numeric)})

test_that("ufo complex subset: NULL",       {test_ufo_subset(data=as.complex(1:100000), subscript=NULL,             ufo_complex)})
test_that("ufo complex subset: 0",          {test_ufo_subset(data=as.complex(1:100000), subscript=0,                ufo_complex)})
test_that("ufo complex subset: 1",          {test_ufo_subset(data=as.complex(1:100000), subscript=1,                ufo_complex)})
test_that("ufo complex subset: N/2",        {test_ufo_subset(data=as.complex(1:100000), subscript=50000,            ufo_complex)})
test_that("ufo complex subset: N",          {test_ufo_subset(data=as.complex(1:100000), subscript=100000,           ufo_complex)})
test_that("ufo complex subset: 1:10",       {test_ufo_subset(data=as.complex(1:100000), subscript=1:10,             ufo_complex)})
test_that("ufo complex subset: 1:1000",     {test_ufo_subset(data=as.complex(1:100000), subscript=1:1000,           ufo_complex)})
test_that("ufo complex subset: 1:N",        {test_ufo_subset(data=as.complex(1:100000), subscript=1:100000,         ufo_complex)})
test_that("ufo complex subset: N/2:N",      {test_ufo_subset(data=as.complex(1:100000), subscript=50000:100000,     ufo_complex)})
test_that("ufo complex subset: 2*(2:N/2)",  {test_ufo_subset(data=as.complex(1:100000), subscript=2*(1:50000),      ufo_complex)})
test_that("ufo complex subset: -1",         {test_ufo_subset(data=as.complex(1:100000), subscript=-1,               ufo_complex)})
test_that("ufo complex subset: -(N/2)",     {test_ufo_subset(data=as.complex(1:100000), subscript=-50000,           ufo_complex)})
test_that("ufo complex subset: -N",         {test_ufo_subset(data=as.complex(1:100000), subscript=-100000,          ufo_complex)})
test_that("ufo complex subset: -(1:10)",    {test_ufo_subset(data=as.complex(1:100000), subscript=-(1:10),          ufo_complex)})
test_that("ufo complex subset: -(1:1000)",  {test_ufo_subset(data=as.complex(1:100000), subscript=-(1:1000),        ufo_complex)})
test_that("ufo complex subset: -(1:N)",     {test_ufo_subset(data=as.complex(1:100000), subscript=-(1:100000),      ufo_complex)})
test_that("ufo complex subset: -(N/2:N)",   {test_ufo_subset(data=as.complex(1:100000), subscript=-(50000:100000),  ufo_complex)})
test_that("ufo complex subset: -2*(2:N/2)", {test_ufo_subset(data=as.complex(1:100000), subscript=-2*(1:50000),     ufo_complex)})

test_that("ufo raw subset: NULL",           {test_ufo_subset(data=as.raw(1:100000),     subscript=NULL,             ufo_raw)})
test_that("ufo raw subset: 0",              {test_ufo_subset(data=as.raw(1:100000),     subscript=0,                ufo_raw)})
test_that("ufo raw subset: 1",              {test_ufo_subset(data=as.raw(1:100000),     subscript=1,                ufo_raw)})
test_that("ufo raw subset: N/2",            {test_ufo_subset(data=as.raw(1:100000),     subscript=50000,            ufo_raw)})
test_that("ufo raw subset: N",              {test_ufo_subset(data=as.raw(1:100000),     subscript=100000,           ufo_raw)})
test_that("ufo raw subset: 1:10",           {test_ufo_subset(data=as.raw(1:100000),     subscript=1:10,             ufo_raw)})
test_that("ufo raw subset: 1:1000",         {test_ufo_subset(data=as.raw(1:100000),     subscript=1:1000,           ufo_raw)})
test_that("ufo raw subset: 1:N",            {test_ufo_subset(data=as.raw(1:100000),     subscript=1:100000,         ufo_raw)})
test_that("ufo raw subset: N/2:N",          {test_ufo_subset(data=as.raw(1:100000),     subscript=50000:100000,     ufo_raw)})
test_that("ufo raw subset: 2*(2:N/2)",      {test_ufo_subset(data=as.raw(1:100000),     subscript=2*(1:50000),      ufo_raw)})
test_that("ufo raw subset: -1",             {test_ufo_subset(data=as.raw(1:100000),     subscript=-1,               ufo_raw)})
test_that("ufo raw subset: -(N/2)",         {test_ufo_subset(data=as.raw(1:100000),     subscript=-50000,           ufo_raw)})
test_that("ufo raw subset: -N",             {test_ufo_subset(data=as.raw(1:100000),     subscript=-100000,          ufo_raw)})
test_that("ufo raw subset: -(1:10)",        {test_ufo_subset(data=as.raw(1:100000),     subscript=-(1:10),          ufo_raw)})
test_that("ufo raw subset: -(1:1000)",      {test_ufo_subset(data=as.raw(1:100000),     subscript=-(1:1000),        ufo_raw)})
test_that("ufo raw subset: -(1:N)",         {test_ufo_subset(data=as.raw(1:100000),     subscript=-(1:100000),      ufo_raw)})
test_that("ufo raw subset: -(N/2:N)",       {test_ufo_subset(data=as.raw(1:100000),     subscript=-(50000:100000),  ufo_raw)})
test_that("ufo raw subset: -2*(2:N/2)",     {test_ufo_subset(data=as.raw(1:100000),     subscript=-2*(1:50000),     ufo_raw)})

test_that("ufo logical subset: NULL",       {test_ufo_subset(data=as.logical(1:100000), subscript=NULL,             ufo_logical)})
test_that("ufo logical subset: 0",          {test_ufo_subset(data=as.logical(1:100000), subscript=0,                ufo_logical)})
test_that("ufo logical subset: 1",          {test_ufo_subset(data=as.logical(1:100000), subscript=1,                ufo_logical)})
test_that("ufo logical subset: N/2",        {test_ufo_subset(data=as.logical(1:100000), subscript=50000,            ufo_logical)})
test_that("ufo logical subset: N",          {test_ufo_subset(data=as.logical(1:100000), subscript=100000,           ufo_logical)})
test_that("ufo logical subset: 1:10",       {test_ufo_subset(data=as.logical(1:100000), subscript=1:10,             ufo_logical)})
test_that("ufo logical subset: 1:1000",     {test_ufo_subset(data=as.logical(1:100000), subscript=1:1000,           ufo_logical)})
test_that("ufo logical subset: 1:N",        {test_ufo_subset(data=as.logical(1:100000), subscript=1:100000,         ufo_logical)})
test_that("ufo logical subset: N/2:N",      {test_ufo_subset(data=as.logical(1:100000), subscript=50000:100000,     ufo_logical)})
test_that("ufo logical subset: 2*(2:N/2)",  {test_ufo_subset(data=as.logical(1:100000), subscript=2*(1:50000),      ufo_logical)})
test_that("ufo logical subset: -1",         {test_ufo_subset(data=as.logical(1:100000), subscript=-1,               ufo_logical)})
test_that("ufo logical subset: -(N/2)",     {test_ufo_subset(data=as.logical(1:100000), subscript=-50000,           ufo_logical)})
test_that("ufo logical subset: -N",         {test_ufo_subset(data=as.logical(1:100000), subscript=-100000,          ufo_logical)})
test_that("ufo logical subset: -(1:10)",    {test_ufo_subset(data=as.logical(1:100000), subscript=-(1:10),          ufo_logical)})
test_that("ufo logical subset: -(1:1000)",  {test_ufo_subset(data=as.logical(1:100000), subscript=-(1:1000),        ufo_logical)})
test_that("ufo logical subset: -(1:N)",     {test_ufo_subset(data=as.logical(1:100000), subscript=-(1:100000),      ufo_logical)})
test_that("ufo logical subset: -(N/2:N)",   {test_ufo_subset(data=as.logical(1:100000), subscript=-(50000:100000),  ufo_logical)})
test_that("ufo logical subset: -2*(2:N/2)", {test_ufo_subset(data=as.logical(1:100000), subscript=-2*(1:50000),     ufo_logical)})